<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">

    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>PARTNER LOGIN API TEST-COPY</title>

    <script src="http://code.jquery.com/jquery-latest.js"></script> 
    
    <style>
        html, body {
            font-family: 'NanumSquare',sans-serif;
            font-weight: 400;
            font-size: 12px;
            color: #000;
            height: 100%;
            margin:0;
            padding:0;
            scroll-behavior: smooth;
            overscroll-behavior: contain;
            word-break: keep-all;

        }
        body::-webkit-scrollbar { display: none;  }
        *,
        *:active,
        *:hover,
        *:focus {
            outline: none !important;
        }
        table {
            display: table;
            border-collapse: separate;
            -webkit-border-horizontal-spacing: 2px;
            -webkit-border-vertical-spacing: 2px;
            border-top-color: gray;
        }

        .form_wrapper {
            width: 50%;
            overflow-x: auto;
            border: 2px solid #42b983;
            margin-bottom: 0 !important;
        }

        table[data-v-90661b74] {
            border-radius: 3px;
            background-color: #fff;
        }
        .grid {
                        width: 100%;
                    }
        *:active, *:hover, *:focus {
                      outline: none !important;
                  }
        table {
            display: table;
            border-collapse: separate;
            -webkit-border-horizontal-spacing: 2px;
            -webkit-border-vertical-spacing: 2px;
            border-top-color: gray;
        }
        .grid_with_form {
            width: 50%;
            -webkit-transition: width 0.5s;
            transition: width 0.5s;
            margin-right: 15px;
        }
        .contents_grid {
                        width: 100%;
                        max-height: 600px;
                        overflow-y: auto;
                        -ms-overflow-style: none;
                        /* overflow-style: initial; */
                        overflow: auto;
                        -webkit-transition: width 0.5s;
                        transition: width 0.5s;
                        border: 2px solid #42b983;
                    }

        btn:not(:disabled):not(.disabled) {
            cursor: pointer;
        }
        .btn-outline-primary:hover {
                         color: #fff;
                         background-color: #007bff;
                         border-color: #007bff;
                     }
        .btn:focus, .btn:hover {
                         text-decoration: none;
                     }
        button:hover, a:hover {
                      cursor: pointer;
                  }
        .btn-outline-primary {
                         color: #007bff;
                         background-color: transparent;
                         background-image: none;
                         border-color: #007bff;
                     }
        .btn {
                         display: inline-block;
                         font-weight: 400;
                         text-align: center;
                         white-space: nowrap;
                         vertical-align: middle;
                         -webkit-user-select: none;
                         -moz-user-select: none;
                         -ms-user-select: none;
                         user-select: none;
                         border: 1px solid transparent;
                         padding: .375rem .75rem;
                         font-size: 1rem;
                         line-height: 1.5;
                         border-radius: .25rem;
                         transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;
                     }

        button {
            margin-top: 0em;
            font-style: normal;
            font-weight: 400;
            font-size: 11px;
            font-family: system-ui;
            font-variant-caps: normal;
            color: initial;
            letter-spacing: normal;
            word-spacing: normal;
            line-height: normal;
            text-transform: none;
            text-indent: 0px;
            text-shadow: none;
            display: inline-block;
            text-align: start;
            box-sizing:border-box;

        }
        .btn-outline-primary {
            color: #007bff;
            background-color: transparent;
            background-image: none;
            border-color: #007bff;
        }
        .input_txt {
            position: relative;
            border-radius: 8px;
            border: solid 1px #ebebeb;
            background-color: #f5f6f9;
            margin: 0;
            line-height: 30px;
            padding-left: 12px;
            padding-right: 12px;
            box-sizing: border-box;
            min-height: 30px;
            /* width: 242px; */
        }
        .input_txt input {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border: none;
            background-color: transparent;
            font-size: 12px;
            color: #181818;
            width: 168px;
        }
        .response_input_txt {
            position: relative;
            border-radius: 8px;
            border: solid 1px #ebebeb;
            background-color: #f5f6f9;
            margin: 0;
            line-height: 30px;
            padding-left: 12px;
            padding-right: 12px;
            box-sizing: border-box;
            min-height: 30px;
            /* width: 242px; */
        }
        .response_input_txt textarea {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            border: none;
            background-color: transparent;
            font-size: 12px;
            color: #181818;
            width: 100%;
            height: 200px;
        }
        input, textarea, keygen, select, button {
            margin-top: 0em;
            font-style: normal;
            font-weight: 400;
            font-size: 11px;
            font-family: system-ui;
            font-variant-caps: normal;
            color: initial;
            letter-spacing: normal;
            word-spacing: normal;
            line-height: normal;
            text-transform: none;
            text-indent: 0px;
            text-shadow: none;
            display: inline-block;
            text-align: start;
        }
        div {
            display: block;
        }

        td, th {
            display: table-cell;
            vertical-align: inherit;
        }

        .grid_with_form {
            width: 50%;
            -webkit-transition: width 0.5s;
            transition: width 0.5s;
            margin-right: 15px;
        }

        .text_label {
            padding-left: 20px;
        }
    </style>

    <script language="JavaScript">


        let redirectUrl = '';

        var host = '';
        window.onload = function () {
            document.getElementById('api_key').value = 'TEST-API-KEY-TALK';
            document.getElementById('member_id').value = 'TEST-MEMBER-FOR-API';
            document.getElementById('merchant_id').value = 'TEST-MERCHANT-FOR-API';

            // host = 'http://dev.paymint.co.kr:10044/partners';
            // host = 'http://stg.paymint.co.kr:10044/partners/merchant';
            host = 'http://stg.paymint.co.kr:10044/partners/merchant';
            // host = "http://stg.paymint.co.kr:10200//if/bill/send" ;
        };


        function login() {
            //  (1 : VWA9U4MWJ1B, 4 : BVJFKTJ0D4Y)
            var _api_key = '';
            var _member_id = '';
            var _merchant_id = '';
       

            _api_key = document.getElementById('api_key').value;
            _member_id = document.getElementById('member_id').value;
            _merchant_id = document.getElementById('merchant_id').value;

            // XMLHttpRequest 객체의 생성
            const xhr = new XMLHttpRequest();

            xhr.open('POST', host);
            xhr.setRequestHeader('Content-type', 'application/json');

            var vat_rate = 10;

            const data = {
                api_key: "TEST-API-KEY-TALK",
                member_id:"TEST-MEMBER-FOR-API",
                merchant_id: "TEST-MERCHANT-FOR-API",

                /////////////////////////////////////////
                // bill: { 
                //     bill_id:"사업자번호-7439900305", 
                //     product_nm:"청구사유, 코드수학테스트", 
                //     message:"안내메세지-잘하자~~", 
                //     member_nm:"고객명- 홍길동", 
                //     phone:"01090437295", 
                //     price:"100", 
                //     hash:"6F846210B6CA2D7E1E07FB50C1FEE1793F113C954A14B4C0", 
                //     expire_dt:"2099-12-31", 
                //     // callbackURL:"https://ef84-175-214-28-198.ngrok-free.app/chk_paymint"                
                //     callbackURL:"http://stg.paymint.co.kr:10044/partners/merchant"                
                //     } 
                bill: { 
                bill_id:"사업자번호-100000011", 
                product_nm:"청구사유, 코드수학테스트", 
                message:"안내메세지-잘하자~~", 
                member_nm:"고객명- 홍길동", 
                phone:"01032677435", 
                price:"10234", 
                hash:"a0213f3f9e45e8540e91a1339e0c5deee2dd27c4cb6b039436538c316bb45fa6", 
                expire_dt:"2099-12-31", 
                // callbackURL:"https://5053-175-214-28-198.ngrok-free.app/chk_paymint"                
                // callbackURL:"http://stg.paymint.co.kr:10044/partners/merchant"                
                // callbackURL: host   
                callbackURL: '/chk_paymint'

                } 
                ////////////////////////////////////////
            };
            console.log("0 data", data);

            xhr.send(JSON.stringify(data));

            // XMLHttpRequest.readyState 프로퍼티가 변경(이벤트 발생)될 때마다 onreadystatechange 이벤트 핸들러가 호출된다.
            xhr.onreadystatechange = function (e) {

                // console.log("1", xhr.response);
                // console.log("2", xhr.status);
                // console.log("3-1", xhr.readyState);
                
                if (xhr.readyState !== XMLHttpRequest.DONE) return;                
                
                // console.log("3-2", xhr.readyState);
                // console.log("4", xhr.status);

                // 정상
                if(xhr.status === 200) {

                    resJson = JSON.parse(xhr.response);
                    // alert(resJson.info)
                    console.log(xhr.response);
                    // location.href = "http://0.0.0.0:14001/" +resJson.info;
                    document.getElementById('response').value = JSON.stringify(resJson, null, 4);

                    document.getElementById('redirectUrl').value = resJson.info.url;

                } else {
                    // console.log("10", xhr.response);
                    console.log('11. Error!');
                }
            };
        };

        function copyUrl() {
            const target = document.getElementById('redirectUrl');

            target.select();

            console.log(target.value);

            document.execCommand("Copy");
            alert("복사되었습니다.");
        }
    </script>
</head>

    <!-- END HEAD -->

    <body class="bg_gray">
       

        <div class="contents_grid grid_with_form" style="width:100%; transform: translate(0%, 50%)">
            <table class="grid" >
                <tr>
                    <td class="text_label"> * API Key 파트너</td>
                    <td><div class="input_txt"><input placeholder="API Key" id="api_key" name="api_key" tabindex="1" autofocus value="VWA9U4MWJ1B"></div></td>
                </tr>
                <tr>
                    <td class="text_label"> * ERP 회원 아이디 </td>
                    <td><div class="input_txt"><input placeholder="회원아이디" id="member_id" name="member_id" tabindex="2"></div></td>
                </tr>
              	<tr>
                    <td class="text_label"> * ERP 가맹점 아이디 </td>
                    <td><div class="input_txt"><input placeholder="가맹점아이디" id="merchant_id" name="merchant_id" tabindex="2"></div></td>
                </tr>

                <tr>
                	<td></td>
                    <td colspan="2" style="text-align: left;">
                        <button style="width: 15%; margin: 20px 0px 20px 0px" type="button" class="btn btn-outline-primary" onclick="javascript:login();">로그인</button>
                    </td>
                </tr>

                <tr>
                    <td class="text_label"> * 응답 값  <p id = 'time'> </p></td>
                    <td><div class="response_input_txt">
                    	<textarea id="response" name="response" tabindex="1" autofocus value="" readonly></textarea>
                    </div>
                    </td>
                </tr>
                <tr>
                	<td></td>
                    <td colspan="2" style="text-align: left;">
                        <button style="width: 15%; margin: 20px 0px 20px 0px" type="button" class="btn btn-outline-primary" onclick="javascript:copyUrl();">응답 URL 복사하기</button>
                        <input type="text" id="redirectUrl" value="" style="position:absolute;top:-9999em;">
                    </td>
                </tr>
                <tr>
            </table>
        </div>
        <!-- <script>
            let today = new Date();       
            var year = today.getFullYear();
            var month = ('0' + (today.getMonth() + 1)).slice(-2);
            var day = ('0' + today.getDate()).slice(-2);
            var hour = ('0' + today.getHours()).slice(-2);
            var minutes = ('0' + today.getMinutes()).slice(-2);
            var seconds = ('0' + today.getSeconds()).slice(-2);  
            var dateString = year + '-' + month  + '-' + day+' '+hour+':'+minutes+':'+seconds;
            console.log('접속시간 : ', dateString)    ;
            $("#time").html(dateString) ;
          </script> -->
    </body>
</html>
